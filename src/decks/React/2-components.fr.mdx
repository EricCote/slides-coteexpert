---
title: Composants React
description: other
---

# Composants et JSX

---

## Cr√©er un SPA

- Un **SPA** est une _Single Page App_
  - Par exemple: Google Maps, Netflix, Instagram, Twitter, etc.
  - Le serveur web doit √™tre configur√© pour rediriger toutes les requ√™tes HTTP vers la page _index_.
- Les SPA classiques sont 100% _front-end_, avec des interactions au _backend_ via des services REST API.
  - Les SPA modernes sont plus complexes et permettent une architecture hybride, o√π le _backend_ joue un r√¥le important.
    - On appelle cette approche le **Pespa** (Progressively Enhanced Single Page Apps)
    - https://www.epicweb.dev/the-webs-next-transition

---

## Points d'entr√©e

- Voici les conventions de **Vite**
- Une page `index.html` poss√®de un `<div id="root"> </div>`
  - le `div` est vide
- le script de d√©marrage se nomme `index.js`

- On pourrait g√©n√©rer des donn√©es dans la racine SANS utiliser React

```js
//On trouve le div
let rootNode = document.getElementById('root');

//Modifier le contenu du DOM. Sans React!
rootNode.innerHTML = '<h2>Bonjour tous!</h2>';
```

---

## JS classique, sans React

<Sandpack s="70" >

```html public/index.html
<!DOCTYPE html>
<html>
  <head>
    <title>My app</title>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
```

```js src/index.js active
import('./style.css'); // Vite syntax.  No React!

const divRoot = document.getElementById('root');
divRoot.innerHTML = '<h1 style="color: blue">Hello World</h1>';

// Play with Interval, put 2000 100 or 100 and see the browser tools.

// function displayTime() {
//   divRoot.innerHTML = `<p>The current time is ${new Date().toLocaleTimeString()}</p>`;
// }

// setInterval(displayTime, 1000);
```

```css src/style.css
body {
  font-family: sans-serif;
  margin: 20px;
  padding: 0;
}
```

</Sandpack>

---

## Point d'entr√©e React

- `Index.js` doit importer `react-dom/client`

- `ReactDOM.createRoot` permet de cr√©er une racine React pour le `<div>`.

```js
//On importe ReactDOM
import * as ReactDOM from 'react-dom/client';

//On trouve le div
const rootNode = document.getElementById('root');

//On cr√©√© une racine React sur le div
const root = ReactDOM.createRoot(rootNode);

//On affiche du jsx sur cette racine
root.render(<h1>Bonjour Tous!</h1>);
```

---

# Racine React

<Sandpack >

```html index.html
<!DOCTYPE html>
<html>
  <head>
    <title>My app</title>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
```

```js src/index.js active
import { createRoot } from 'react-dom/client';
import('./styles.css');

const divRoot = document.getElementById('root');
const root = createRoot(divRoot);

root.render(<h1 style={{ color: 'blue' }}>Bonjour Tous!</h1>);

// strings are encoded
// root.render('<h1 style="color: blue">Hello World</h1>');

//----

// the "commit" phase will determine the minimal DOM update,
// by comparing the current and previous renders.
// See the inspect tools in browser

function DisplayTime() {
  root.render(<p>The current time is {new Date().toLocaleTimeString()}</p>);
}

// setInterval(DisplayTime, 1000);
```

</Sandpack>

---

## Jsx dans variable

On peut stocker le jsx dans une variable.

```jsx
let jsx = <h2>Bonjour Tous!</h2>;

root.render(jsx);
```

---

## Composant

Fonction qui retourne du JSX, combinant HTML, CSS et JS.

La premi√®re lettre doit √™tre une majuscule.

```js
function Bonjour() {
  return <h2>Bonjour Tous!</h2>;
}

//on pourrait appeler tel qu'une fonction üö´
root.render(Bonjour());

//Mieux vaut utiliser la syntaxe JSX  ‚úÖ
root.render(<Bonjour />);
```

---

## Distinguer entre Composant et DOM

**R√®gle** On distingue le Composant d'une balise DOM par la premi√®re lettre:

- `div` et `h1` commencent par des minuscules. React g√©n√®re des balises HTML.
- `Bonjour` commence par une majuscule. React appelle le composant.

```js
root.render(
  <div>
    <h1>Salutations</h1>
    <Bonjour />
    <Bonjour />
    <Bonjour />
  </div>
);
```

---

## D√©couper les composants dans fichiers diff√©rents

**R√®gle** Quand on isole le composant dans son propre fichier, il faut utiliser `export default`

**R√®gle** Quand on √©crit le JSX sur plusieurs lignes, il faut entourer de parenth√®ses ()

<TwoColumns style={{alignItems: 'stretch'}}>

```js
export default function Bonjour() {
  return <h2>Bonjour Tous!</h2>;
}
```

{/* prettier-ignore */}
```js
export default function Bonjour() {
  return (
    <h2>Bonjour Tous!</h2>
  );
}
```

</TwoColumns>

---

## Le JSX ne permet qu'une seule racine

<TwoColumns style={{alignItems: 'stretch'}}>

```js
// Erreur: deux racines  üö´
<h1>Titre</h1>
<h2>Sous-titre</h2>
```

```js
// une racine qui englobe  ‚úÖ
<div>
  <h1>Titre</h1>
  <h2>Sous-titre</h2>
</div>
```

</TwoColumns>

---

## Le fragment

Le fragment permet d'englober sans g√©n√©rer d'√©l√©ment dans le DOM

<TwoColumns style={{alignItems: 'stretch'}}>

```js
// Fragment avec importation ‚úÖ
import { Fragment } from 'react';

<Fragment>
  <h1>Titre</h1>
  <h2>Sous-titre</h2>
</Fragment>;
```

```js
// Fragment implicite  ‚úÖ‚úÖ
<>
  <h1>Titre</h1>
  <h2>Sous-titre</h2>
</>
```

</TwoColumns>

Les 2 approches sont √©quivalentes (compilent de fa√ßon identique). La seconde est plus populaire.

---

## Pas de composants imbriqu√©s

Ne jamais imbriquer les composants les uns dans les autres.

<aside style={{display:'grid', gridTemplateColumns:"1fr 1fr", columnGap:5}}>

```js
function Composant1() {
  function Composant2() {
    //Composant imbriqu√©  üö´
    return <br />;
  }
  return <Composant2 />;
}
```

```js
function Composant1() {
  //Pas imbriqu√©  ‚úÖ
  return <Composant2 />;
}

function Composant2() {
  //Pas imbriqu√©  ‚úÖ
  return <br />;
}
```

</aside>

C'est correct d'imbriquer des gestionnaires d'√©v√©nements et d'autres fonctions.

Le probl√®me d'imbriquer des composants, c'est la performance. (Chaque rendu de Composant1 va g√©n√©rer un nouveau Composant2, avec un nouvel √©tat... )

---

### D√©fi 1

Il manque quelque chose pour que le fichier soit d√©tectable par React. (indice: exportation)

<Sandpack>

```js
function Profile() {
  return <img src='https://i.imgur.com/lICfvbD.jpg' alt='Aklilu Lemma' />;
}
```

```css
img {
  height: 181px;
}
```

</Sandpack>

---

### D√©fi 2

La commande `return` ne fonctionne pas. Commment r√©parer?

<Sandpack>

```js
export default function Profile() {
  return;
  <img src='https://i.imgur.com/jA8hHMpm.jpg' alt='Katsuko Saruhashi' />;
}
```

```css
img {
  height: 180px;
}
```

</Sandpack>

---

### D√©fi 3

Pourquoi cela √©choue? (Indice: qu'est-ce qui distingue les composants et les balises html.)

<Sandpack>

```js
function profile() {
  return <img src='https://i.imgur.com/QIrZWGIs.jpg' alt='Alan L. Hart' />;
}

export default function Gallery() {
  return (
    <section>
      <h1>Liste de personnes</h1>
      <profile />
      <profile />
      <profile />
    </section>
  );
}
```

```css
img {
  margin: 0 10px 10px 0;
  height: 90px;
}
```

</Sandpack>

---

### D√©fi 4

        √âcrire un composant `Entete` qui retourne un gros titre qui
          dit `Bravo!`.

<Sandpack>

```js
// √âcrivez votre composant ici...
```

</Sandpack>

---

## Racine App

**Convention:** avec Create-React-App et Vite, la composante racine se nomme `App.jsx`.

**Convention:** On peut utiliser l'extension `.jsx` ou `.js`

{/* prettier-ignore */}
- Les extensions sont interchangeables
  - `Vite`, `Github` et `Remix` pr√©f√®rent `.jsx`
  - `Next` et `React` pr√©f√®rent `.js`

<div></div>

- Pour l'importation, l'extension `.js` ou `.jsx` est optionnelle.

```js
import Composant from './Composant.js';  ‚úÖ
import Composant from './Composant';  ‚úÖ ‚úÖ
```

---

## S√©parer des composants (VS Code)

R√©usiner ou remanier le code (refactoring) par outils de VSCode.

##### S√©parer jsx vers un composant

1. `Ctrl-.` sur du JSX s√©lectionn√© (ou clic-droit, menu `Remanier...`(`Refactor...`))
2. S√©lectionner `Extraire vers function dans la port√©e module` (`Extract function to module scope`)

##### Isoler composant vers un nouveau fichier

1. `Ctrl-.` sur nom de fonction (ou clic-droit, menu `Remanier...` (`Refactor...`))
2. S√©lectionner `D√©placer vers un nouveau fichier` (`Move to a new file`)
3. `Ctrl-.` sur mot export (ou clic-droit, menu `Remanier...` (`Refactor...`))
4. S√©lectionner `Convert named export to default export`

---

## S√©parer des composants (Manuellement)

Il faut ajouter un `export` (nomm√©) ou un `export default` quand on d√©place le code.

Ne pas oublier d'adapter l'importation avec la commande import

- avec accolades {} pour une exportation nomm√©e
- sans accolades pour l'exportation par d√©faut

---

## Types d'Exportations

<img
  height='400'
  style={{ marginTop: -40 }}
  src='/img/react/i_import-export.svg'
  alt='Default and named exports'
/>

import './table.css';

<table className="my-tbl">
  <thead>
    <tr>
      <th>Syntaxe</th>
      <th >Export</th>
      <th>Import</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th >par d√©faut</th>
      <td >
`export default function Button() {}`
</td>
<td>
`import  Button  from './button.js';`
  </td>
</tr>
<tr>
  <th>Nomm√©e</th>
  <td > 
`export         function Button() {}`
  </td>
  <td>
`import {Button} from './button.js';` 
  </td>
    </tr>

  </tbody>
</table>

- Avec un import par d√©faut, on peut renommer l'importation comme on veut.
- ex: `import LeBouton from './button.js';`

---

### D√©fi 5

D√©placer la composante Profile dans son fichier `Profile.js`;

<Sandpack>

```js src/App.js
import Gallery from './Gallery.js';
import { Profile } from './Gallery.js';

export default function App() {
  return (
    <div>
      <Profile />
    </div>
  );
}
```

```js src/Gallery.js active
// d√©placer ceci vers Profile.js!
export function Profile() {
  return <img src='https://i.imgur.com/QIrZWGIs.jpg' alt='Alan L. Hart' />;
}

export default function Gallery() {
  return (
    <section>
      <h1>Liste de personalit√©s</h1>
      <Profile />
      <Profile />
      <Profile />
    </section>
  );
}
```

```js src/Profile.js
// vide pour le moment
```

```css
img {
  margin: 0 10px 10px 0;
  height: 90px;
}
```

</Sandpack>

---

## Formule JSX

- Gr√¢ce au JSX, on combine HTML et JavaScript ensemble.
- JSX et React sont deux technologies diff√©rentes et s√©par√©es
  - On pourrait utiliser l'un sans l'autre

---

## R√®gles de JSX

1. **Une seule racine**

On peut combiner avec une balise qui englobe (`<div>`) ou un fragment (`<></>`)

<hr />

2. **Balises sont explicitement ferm√©es**

Pas de `<img>` mais plut√¥t `<img />`

<hr />

3. **Utiliser le camelCase pour les attributs**

JSX est converti en JavaScript par la bo√Æte √† outils. Les attributs sont alors transform√©s en propri√©t√©s du DOM (qui sont en camelCase).

`stroke-width` devient `strokeWidth`, `class` devient `className` (car `class` est un mot-r√©serv√© en JS).

Consultez la liste des attributs sur la [documentation React](https://react.dev/reference/react-dom/components/common)

**Exception:** `aria-*` et `data-*`

---

### D√©fi 6

R√©parer les nombreuses petites erreurs du code JSX

<Sandpack>

```js
export default function Bio() {
  return (
    <div class="intro">
      <h1>Bienvenue √† mon site Web!</h1>
    </div>
    <p class="summary">
      Vous pouvez lire mes r√©flexions
      <br><br>
      <b>et voir des <i>photos</b></i> de gens!
    </p>
  );
}
```

```css
.intro {
  background-image: linear-gradient(
    to left,
    violet,
    indigo,
    blue,
    green,
    yellow,
    orange,
    red
  );
  background-clip: text;
  color: transparent;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.summary {
  padding: 20px;
  border: 10px solid gold;
}
```

</Sandpack>

---

## JavaScript dans JSX

On utilise les accolades {} pour ins√©rer des expressions Javascript dans JSX

```jsx
//js dans le texte jsx
<h1>Bonjour {user.name}!</h1>
```

```jsx
//js utilis√© avec attributs
<img className='usager' src={user.imageUrl} />
```

```jsx
//Deux paires d'accolades:
//la premi√®re pour utiliser du JS,
//la seconde pour d√©finir un objet JS
<img className='usager' src='photo.jpg' style={{ width: 50, height: 50 }} />
```

---

### D√©fi 7

R√©parer pourquoi ceci √©choue avec l'erreur `Objects are not valid as a
React child`.

<Sandpack>

```js
const person = {
  name: 'Gregorio Y. Zara',
  theme: {
    backgroundColor: 'black',
    color: 'pink',
  },
};

export default function TodoList() {
  return (
    <div style={person.theme}>
      <h1>Les choses √† faire pour {person}</h1>
      <img
        className='avatar'
        src='https://i.imgur.com/7vQD0fPs.jpg'
        alt='Gregorio Y. Zara'
      />
      <ul>
        <li>Acheter du lait</li>
        <li>Promener le chien</li>
        <li>Faire la lessive</li>
      </ul>
    </div>
  );
}
```

```css
body {
  padding: 0;
  margin: 0;
}
body > div > div {
  padding: 20px;
}
.avatar {
  border-radius: 50%;
  height: 90px;
}
```

</Sandpack>

---

### D√©fi 8

Enlever l'URL de l'image pour l'ajouter dans l'objet `person`

<Sandpack>

```js
const person = {
  name: 'Gregorio Y. Zara',
  theme: {
    backgroundColor: 'black',
    color: 'pink',
  },
};

export default function TodoList() {
  return (
    <div style={person.theme}>
      <h1>Les choses √† faire pour {person.name}</h1>
      <img
        className='avatar'
        src='https://i.imgur.com/7vQD0fPs.jpg'
        alt='Gregorio Y. Zara'
      />
      <ul>
        <li>Acheter du lait</li>
        <li>Promener le chien</li>
        <li>Faire la lessive</li>
      </ul>
    </div>
  );
}
```

```css
body {
  padding: 0;
  margin: 0;
}
body > div > div {
  padding: 20px;
}
.avatar {
  border-radius: 50%;
  height: 90px;
}
```

</Sandpack>

---

### D√©fi 9

Dans l'objet ci-bas, l'url de l'image est s√©par√© en 4 parties: base URL, `imageId`, `imageSize`, et l'extention de fichier.

Dans l'URL de l'image, nous voulons combiner ces attributs : base URL (toujours `'https://i.imgur.com/'`), `imageId` (`'7vQD0fP'`), `imageSize` (`'s'`), et l'extention de fichier (toujours `'.jpg'`). Quelque chose cloche avec le `src` de la balise `<img>`

R√©parez le code. (Indice: utilisez un gabarit (string template))

<Sandpack>

```js
const baseUrl = 'https://i.imgur.com/';
const person = {
  name: 'Gregorio Y. Zara',
  imageId: '7vQD0fP',
  imageSize: 's',
  theme: {
    backgroundColor: 'black',
    color: 'pink',
  },
};

export default function TodoList() {
  return (
    <div style={person.theme}>
      <h1>Les choses √† faire pour {person.name}</h1>
      <img
        className='avatar'
        src='{baseUrl}{person.imageId}{person.imageSize}.jpg'
        alt={person.name}
      />
      <ul>
        <li>Acheter du lait</li>
        <li>Promener le chien</li>
        <li>Faire la lessive</li>
      </ul>
    </div>
  );
}
```

```css
body {
  padding: 0;
  margin: 0;
}
body > div > div {
  padding: 20px;
}
.avatar {
  border-radius: 50%;
  height: 90px;
}
```

</Sandpack>

---

## Passer des props dans des composants

React utilise des props pour passer de l'information entre les composants.

On peut passer des cha√Ænes de caract√®res, des objets, des tableaux, des fonctions, etc.

<hr />

### Props familiers

`className, src, alt, width, height` sont des props familiers

```jsx
<img
  className='avatar'
  src='https://i.imgur.com/1bX5QH6.jpg'
  alt='Lin Lanying'
  width={100}
  height={100}
/>
```

---

## Passer des props

#### Pousser des props au composant enfant

```jsx
<Avatar
  person={{ name: 'Lin Lanying', imageId: '1bX5QH6' }}
  size={100}
  rounded
/>
```

---

## Lire les props

<TwoColumns  top>

```js
// lecture du param√®tre props   ‚úÖ
function Avatar(props) {
  let person = props.person;
  let size = props.size;
  // ...
}
```

```js
// d√©composition du param√®tre props   ‚úÖ‚úÖ‚úÖ
function Avatar({ person, size }) {
  // person et size sont accessibles
}
```

</TwoColumns>

Les deux approches sont √©quivalentes.

L'affectation par d√©composition (destructuring) avec `{}` est populaire.

---

## Valeur Par d√©faut

```js
function Avatar({ person, size = 100 }) {
  // ...
}
```

La valeur par d√©faut est utilis√©e quand `size` n'est pas pr√©sent ou quand `size={undefined}`

---

## Passer des props avec la syntaxe de d√©composition (spread)

<TwoColumns top>

{/* prettier-ignore */}
```jsx
// Approche d√©taill√©e
function Profile({ person, size, 
                   isSepia, thickBorder }) {
  return (
    <div className='card'>
      <Avatar
        person={person}
        size={size}
        isSepia={isSepia}
        thickBorder={thickBorder}
      />
    </div>
  );
}
```

```jsx
// Approche syntaxe de d√©composition
// en anglais: spread syntax
function Profile(props) {
  return (
    <div className='card'>
      <Avatar {...props} />
    </div>
  );
}
```

</TwoColumns>

Les deux approches sont √©quivalentes.

---

## Passer du JSX ou contenu en props children

```js
<Cadre>
  <Avatar />
</Cadre>;

function Cadre({ children }) {
  return <div className='cadre'>{children}</div>;
}
```

---

## Caract√©ristiques des props

- Les props re√ßus sont en lecture seulement. Il faut les consid√©rer _immuables_.

- On ne peut changer un props. Si on a besoin d'interactivit√©, on utilise plut√¥t l'√©tat (state).

---

### D√©fi 10

Le composant `Gallery` contient des balises similaires pour afficher les profiles. Extraire un composant `Profile` pour r√©duire le code redondant. Choisissez les props n√©cessaires.

<Sandpack>

```js src/App.js
import { getImageUrl } from './utils.js';

export default function Gallery() {
  return (
    <div>
      <h1>Scientifiques remarquables</h1>
      <section className='profile'>
        <h2>Maria Sk≈Çodowska-Curie</h2>
        <img
          className='avatar'
          src={getImageUrl('szV5sdG')}
          alt='Maria Sk≈Çodowska-Curie'
          width={70}
          height={70}
        />
        <ul>
          <li>
            <b>Sp√©cialit√©: </b>
            Physique et Chimie
          </li>
          <li>
            <b>Prix et distinctions: 4 </b>
            (Prix Nobel en physique, Prix Nobel en Chimie, M√©daille Davy, M√©daille
            Matteucci)
          </li>
          <li>
            <b>D√©couverte: </b>
            polonium (√©l√©ment)
          </li>
        </ul>
      </section>
      <section className='profile'>
        <h2>Katsuko Saruhashi</h2>
        <img
          className='avatar'
          src={getImageUrl('YfeOqp2')}
          alt='Katsuko Saruhashi'
          width={70}
          height={70}
        />
        <ul>
          <li>
            <b>Sp√©cialit√©: </b>
            G√©o-chimie
          </li>
          <li>
            <b>Prix et distinctions: 2 </b>
            (Prix g√©ochimie Miyake, Prix Tanaka)
          </li>
          <li>
            <b>D√©couverte: </b>
            m√©thode pour mesurer le dioxide de carbone dans l'eau de mer
          </li>
        </ul>
      </section>
    </div>
  );
}
```

```js src/utils.js
export function getImageUrl(imageId, size = 's') {
  return 'https://i.imgur.com/' + imageId + size + '.jpg';
}
```

```css
.avatar {
  margin: 5px;
  border-radius: 50%;
  min-height: 70px;
}
.profile {
  border: 1px solid #aaa;
  border-radius: 6px;
  margin-top: 20px;
  padding: 10px;
}
h1,
h2 {
  margin: 5px;
}
h1 {
  margin-bottom: 10px;
}
ul {
  padding: 0px 10px 0px 20px;
}
li {
  margin: 5px;
}
```

</Sandpack>

---

### D√©fi 11

Dans cet exemple, `Avatar` re√ßoit une prop `size` num√©rique pour la taille du `<img>`. Dans cet exemple, la taille affich√© est 40. Mais la taille de l'image t√©l√©charg√©e est 160px. La taille de l'image t√©l√©charg√©e devrait s'adapter d'apr√®s la taille affich√©e.

Changez le composant `Avatar` pour t√©l√©charger l'image d'apr√®s la taille d'affichage. Si la taille est moins de 90, passez le param√®tre `s` (small) plut√¥t que `b` (big) √† la fonction `getImageUrl`. Testez en affichant des Avatars de tailles diff√©rentes. (Bonus: on pourrait prendre en compte les √©crans denses avec `window.devicePixelRatio`)

<Sandpack>

```js src/App.js
import { getImageUrl } from './utils.js';

function Avatar({ person, size }) {
  return (
    <img
      className='avatar'
      src={getImageUrl(person, 'b')}
      alt={person.name}
      width={size}
      height={size}
    />
  );
}

export default function Profile() {
  return (
    <Avatar
      size={40}
      person={{
        name: 'Gregorio Y. Zara',
        imageId: '7vQD0fP',
      }}
    />
  );
}
```

```js src/utils.js
export function getImageUrl(person, size) {
  return 'https://i.imgur.com/' + person.imageId + size + '.jpg';
}
```

```css
.avatar {
  margin: 20px;
  border-radius: 50%;
}
```

</Sandpack>

---

### D√©fi 12

Extraire un composant `Card` du code ci-bas. Utilisez la prop `children` pour lui passer du JSX diff√©rent:

<Sandpack>

```js
export default function Profile() {
  return (
    <div>
      <div className='card'>
        <div className='card-content'>
          <h1>Photo</h1>
          <img
            className='avatar'
            src='https://i.imgur.com/OKS67lhm.jpg'
            alt='Aklilu Lemma'
            width={70}
            height={70}
          />
        </div>
      </div>
      <div className='card'>
        <div className='card-content'>
          <h1>√Ä Propos</h1>
          <p>
            Aklilu Lemma est un scientifique √âthiopien qui a d√©couvert un
            traitement naturel au schistosomiase.
          </p>
        </div>
      </div>
    </div>
  );
}
```

```css
.card {
  width: fit-content;
  margin: 20px;
  padding: 20px;
  border: 1px solid #aaa;
  border-radius: 20px;
  background: #fff;
}
.card-content {
  text-align: center;
}
.avatar {
  margin: 10px;
  border-radius: 50%;
}
h1 {
  margin: 5px;
  padding: 0;
  font-size: 24px;
}
```

</Sandpack>

---

## Rendu conditionnel

Diff√©rentes approches

<TwoColumns>
<div>

M√©thode classique, utiliser des instructions `if`:

```jsx
let contenu;
if (vip) {
  contenu = <Vip />;
} else {
  contenu = <Regulier />;
}
return <div>{contenu}</div>;
```

</div>

<div>

M√©thode compacte, utiliser l'op√©rateur conditionnel ternaire <br/> `(expression ? resultat_vrai : resultat_faux)`

```jsx
<div>{vip ? <Vip /> : <Regulier />}</div>
```

M√©thode sans `else`, utiliser l'op√©rateur logique `&&`

```jsx
<div>{vip && <Vip />}</div>
```

</div>

</TwoColumns>

---

### D√©fi 13

Utilisez l'op√©rateur ternaire conditionnel (`cond ? a : b`) pour afficher ‚ùå quand `estRang√©` n'est pas vrai.

<Sandpack>

```js
function Item({ nom, estRang√© }) {
  return (
    <li className='item'>
      {nom} {estRang√© && '‚úî'}
    </li>
  );
}

export default function ListeBaggages() {
  return (
    <section>
      <h1>Liste du contenu des baggages</h1>
      <ul>
        <Item estRang√©={true} nom='Brosse √† dents' />
        <Item estRang√©={true} nom='Maillot de bain' />
        <Item estRang√©={false} nom='Guitare' />
      </ul>
    </section>
  );
}
```

</Sandpack>

---

### D√©fi 14

Dans cet exemple, chaque `Item` re√ßoit une prop num√©rique nomm√©e `importance`. Utilisez l'op√©rateur && pour afficher _(Importance: X)_ en italiques, mais seulement pour les items qui ont une importance autre que 0.

Votre liste d'items doit ressembler √† ceci:

- Brosse √† dents _(Importance: 9)_
- Maillot de bain
- Guitare _(Importance: 6)_

Noubliez pas l'espace entre les deux √©tiquettes. `{' '}`

<Sandpack>

```js
function Item({ name, importance }) {
  return <li className='item'>{name}</li>;
}

export default function PackingList() {
  return (
    <section>
      <h1>Sally Ride's Packing List</h1>
      <ul>
        <Item importance={9} name='Space suit' />
        <Item importance={0} name='Helmet with a golden leaf' />
        <Item importance={6} name='Photo of Tam' />
      </ul>
    </section>
  );
}
```

</Sandpack>

---

### D√©fi 15

La composante `Boisson` utilise une s√©rie de conditions ternaires ` ? :` pour afficher diff√©rentes informations d√©pendant si le nom de la boisson est un "th√©" ou un "caf√©". Le probl√®me c'est que l'information est r√©partie √† travers diverses conditions. R√©√©crivez ce code pour n'utiliser qu'un seul `if` plut√¥t que trois op√©rations ternaires.

<Sandpack>

```js
function Boisson({ nom }) {
  return (
    <section>
      <h1>{nom}</h1>
      <dl>
        <dt>Partie de la plante</dt>
        <dd>{name === 'th√©' ? 'feuilles' : 'grains'}</dd>
        <dt>Taux de Caf√©ine</dt>
        <dd>{name === 'th√©' ? '15‚Äì70 mg/tasse' : '80‚Äì185 mg/tasse'}</dd>
        <dt>Age</dt>
        <dd>{name === 'th√©' ? '4 000+ ans' : '1 000+ ans'}</dd>
      </dl>
    </section>
  );
}

export default function ListeBoissons() {
  return (
    <div>
      <Boisson nom='th√©' />
      <Boisson nom='caf√©' />
    </div>
  );
}
```

</Sandpack>

---

## G√©rer des listes

Il est facile d'utiliser des fonctions telles que `map` et `filter` pour travailler avec des donn√©es.

```js
const personnalit√©s = [
  'Fran√ßois Legault: politicien',
  'Isabelle Boulay: artiste',
  'Fran√ßois Bellefeuille: humoriste',
  'Pierre Lapointe: artiste',
  'V√©ronique Cloutier: animatrice',
];
```

```js
const listeItems = personnalit√©s.map((personne) => <li>{personne}</li>);
```

```js
return <ul>{listeItems}</ul>;
```

---

## Donn√©es complexes

Avec une structure plus complexe, filtrons et affichons:

<TwoColumns top>

```js
const personnalit√©s = [
  {
    id: 0,
    nom: 'Fran√ßois Legault',
    profession: 'politicien',
  },

  {
    id: 1,
    nom: 'Isabelle Boulay',
    profession: 'artiste',
  },

```

```js

  {
    id: 2,
    nom: 'Fran√ßois Bellefeuille',
    profession: 'humoriste',
  },
  {
    id: 3,
    nom: 'Pierre Lapointe',
    profession: 'artiste',
  },
  {
    id: 4,
    nom: 'V√©ronique Cloutier',
    profession: 'animatrice',
  },
];
```

</TwoColumns>

---

### Filtrer les artistes

`.filter` est une fonction standard de js.

```js
const artistes = personnalit√©s.filter((p) => p.profession === 'artiste');
```

---

### Faire un map

Map retourne un nouveau tableau d'√©l√©ments.

```js
const listeItems = artistes.map((personne) => (
  <li>
    <img src={getImageUrl(personne)} alt={personne.nom} />
    <p>
      <b>{personne.nom}:</b>
      {' ' + personne.profession}
    </p>
  </li>
));
```

Afficher les r√©sultats

```js
return <ul>{listeItems}</ul>;
```

---

## Note sur les fonctions fl√®ches

Si on √©crit une fonction f√®che **avec** accolades {}, il faut mettre le `return` explicitement.

{/* prettier-ignore */}
```js
const liste = artistes.map((p) => { return <li>...</li>; });
```

Si on √©crit une fonction fl√®che **sans** accolades, le `return` est implicite et il ne faut pas l'√©crire.

```js
const liste = artistes.map((p) => <li>...</li>);
```

---

## G√©rer les cl√©s

Si on oublie de sp√©cifier une `key` unique, un message est affich√© dans la console

<div className='alert alert-danger'>
  Warning: Each child in a list should have a unique ‚Äúkey‚Äù prop.
</div>

Pour √©liminer le message, il faut utiliser une cl√© unique.
Il faut fournir cela pour n'importe quel tableau de JSX, incluant le `map`.

Ceci am√©liore les performances si on doit trier, ajouter ou enlever
des √©l√©ments. Ceci permet √† React de mieux comprendre ce qui a √©t√© modifi√©.

---

## D'o√π proviennent les cl√©s

1. Prendre la cl√© de la base de donn√©es quand les donn√©es proviennent d'une BD
2. Si les donn√©es sont locales, on g√©n√®re nos propres cl√©s avec un `counter`, `crypto.randomUUID()` ou le package `uuid`.

**Important**

- Les cl√©s doivent √™tre uniques
- Les cl√©s doivent √™tre immuables, elles ne doivent pas √™tre chang√©es, ni reg√©n√©r√©es.

- `key` n'est PAS une prop, mais une caract√©ristique utilis√©e par React. Si la composante
  a aussi besoin de cette info, il faut alors cr√©er une prop avec un autre nom.
  ex: `<Profile key={id} userId={id} />`.

---

### D√©fi 16

Voici une liste de scientifiques. Modifiez cette liste pour avoir 2 listes: une liste de chimistes, et une liste de tous les autres. On filtre un chimiste avec `personne.profession === 'chimiste'`

<Sandpack>

```js src/App.js
import { people } from './data.js';
import { getImageUrl } from './utils.js';

export default function List() {
  const listItems = people.map((person) => (
    <li key={person.id}>
      <img src={getImageUrl(person)} alt={person.name} />
      <p>
        <b>{person.name}:</b> est un{person.gender === 'f' && 'e'}
        {' ' + person.profession + ' '}
        reconnu{person.gender === 'f' && 'e'} pour {person.accomplishment}
      </p>
    </li>
  ));
  return (
    <article>
      <h1>Scientifiques</h1>
      <ul>{listItems}</ul>
    </article>
  );
}
```

```js src/data.js
export const people = [
  {
    id: 0,
    name: 'Creola Katherine Johnson',
    gender: 'f',
    profession: 'math√©maticienne',
    accomplishment: 'le calcul de vols spaciaux',
    imageId: 'MK3eW3A',
  },
  {
    id: 1,
    name: 'Mario Jos√© Molina-Pasquel Henr√≠quez',
    profession: 'chimiste',
    accomplishment:
      "la d√©couverte du trou de la couche d'ozone au dessus de l'Artique.",
    imageId: 'mynHUSa',
  },
  {
    id: 2,
    name: 'Mohammad Abdus Salam',
    profession: 'physicien',
    accomplishment:
      "la t√©horie des comportements autour de l'√©lectromagn√©tisme",
    imageId: 'bE7W1ji',
  },
  {
    id: 3,
    name: 'Percy Lavon Julian',
    profession: 'chimiste',
    accomplishment:
      'le travail autour de la cortisone, des st√©ro√Ødes et de la pilule contraceptive',
    imageId: 'IOjWm71',
  },
  {
    id: 4,
    name: 'Subrahmanyan Chandrasekhar',
    profession: 'astrophysicien',
    accomplishment: 'le calcul de la masse des √©toiles naines blanches',
    imageId: 'lrWQx8l',
  },
];
```

```js src/utils.js
export function getImageUrl(person) {
  return 'https://i.imgur.com/' + person.imageId + 's.jpg';
}
```

```css
ul {
  list-style-type: none;
  padding: 0px 10px;
}
li {
  margin-bottom: 10px;
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 20px;
  align-items: center;
}
img {
  width: 100px;
  height: 100px;
  border-radius: 50%;
}
```

</Sandpack>

---

### D√©fi 17

R√©alisez une liste de recettes! Pour chaque recette, affichez son nom et sa liste d'ingr√©dients. Affichez le nom dans un `<h2>` et les ingr√©dients dans un `<ul>`.

<Sandpack>

```js src/App.js
import { recettes } from './data.js';

export default function ListeRecettes() {
  return (
    <div>
      <h1>Recettes</h1>
    </div>
  );
}
```

```js src/data.js
export const recettes = [
  {
    id: 'greek-salad',
    name: 'Salade grecque',
    ingredients: ['tomates', 'concombres', 'oignon', 'olives', 'feta'],
  },
  {
    id: 'hawaiian-pizza',
    name: 'Pizza hawa√Øenne',
    ingredients: [
      'croute √† pizza',
      'sauce pizza',
      'mozzarella',
      'jambon',
      'ananas',
    ],
  },
  {
    id: 'hummus',
    name: 'Houmous',
    ingredients: [
      'pois chiches',
      "huile d'olive",
      "gousses d'ail",
      'citron',
      'tahini',
    ],
  },
];
```

</Sandpack>

---

### D√©fi 18

Le composant `ListeRecettes` contient deux `map` imbriqu√©s. Pour simplifier, ajoutez un composant `Recette` qui accepte les props `id`, `name` et `ingredients`. N'oubliez pas de g√©rer le `key`.

<Sandpack>

```js src/App.js
import { recettes } from './data.js';

export default function ListeRecettes() {
  return (
    <div>
      <h1>Recettes</h1>
      {recettes.map((recette) => (
        <div key={recette.id}>
          <h2>{recette.name}</h2>
          <ul>
            {recette.ingredients.map((ingredient) => (
              <li key={ingredient}>{ingredient}</li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  );
}
```

```js src/data.js
export const recettes = [
  {
    id: 'greek-salad',
    name: 'Salade grecque',
    ingredients: ['tomates', 'concombres', 'oignon', 'olives', 'feta'],
  },
  {
    id: 'hawaiian-pizza',
    name: 'Pizza hawa√Øenne',
    ingredients: [
      'croute √† pizza',
      'sauce pizza',
      'mozzarella',
      'jambon',
      'ananas',
    ],
  },
  {
    id: 'hummus',
    name: 'Houmous',
    ingredients: [
      'pois chiches',
      "huile d'olive",
      "gousses d'ail",
      'citron',
      'tahini',
    ],
  },
];
```

</Sandpack>

---

### D√©fi 19

Cet exemple affiche un ha√Øku, chaque ligne est englob√©e par un `<p>`. Il faut ajouter des s√©parateurs `<hr />` entre chaque paragraphe. Le r√©sultat doit √™tre:

```js
<article>
  <p>au vent de la mer</p>
  <hr />
  <p>ondulation des √©pis</p>
  <hr />
  <p>en vagues vertes</p>
</article>
```

Un ha√Øku contient trois lignes, mais votre solution doit fonctionner avec des ha√Øku de longueur variable. Notez que `<hr />` s'affiche entre les `<p>`, pas au d√©but ni √† la fin.

<Sandpack>

```js
const poem = {
  lines: ['au vent de la mer', 'ondulation des √©pis', 'en vagues vertes'],
};

export default function Poem() {
  return (
    <article>
      {poem.lines.map((line, index) => (
        <p key={index}>{line}</p>
      ))}
    </article>
  );
}
```

```css
body {
  text-align: center;
}
p {
  font-family: Georgia, serif;
  font-size: 20px;
  font-style: italic;
}
hr {
  margin: 0 120px 0 120px;
  border: 1px dashed #45c3d8;
}
```

</Sandpack>

---

## Composants doivent √™tre purs

En informatique, une fonction pure est une fonction sans effets de bord, sans effets secondaires.

Voici une fonction pure:

```js
function doubler(nombre) {
  return 2 * nombre;
}
```

React assume que chaque composant que vous cr√©ez est pur.
Pour la m√™me "entr√©e", on obtient toujours le m√™me r√©sultat.

---

## Exemple d'un composant pur

<Sandpack>
```js src/App.js
function Recipe({ nbPersonnes }) {
  return (
    <ol>
      <li>Bouillir {nbPersonnes} tasses d'eau</li>
      <li>Ajouter {nbPersonnes} cuill√®res √† soupe de th√©,</li>
      <li>Ajouter {0.5 * nbPersonnes} cuill√®res √† soupe d'√©pices</li>
      <li>Ajouter {0.5 * nbPersonnes} tasses de lait √† √©bulition</li>
      <li>Sucrer au besoin</li>
    </ol>
  );
}

export default function App() {
  return (
    <section>
      <h1>Recette de th√© Chai</h1>
      <h2>Pour deux personnes</h2>
      <Recipe nbPersonnes={2} />
      <h2>Pour un groupe</h2>
      <Recipe nbPersonnes={4} />
    </section>
  );
}
```

</Sandpack>

---

## Effets de bord

Faire le rendu d'un composant devrait seulement g√©n√©rer du JSX.
On ne devrait jamais changer les variables ou les objets qui existent AVANT
le rendu.

Voici un composant qui brise la r√®gle:

<Sandpack>

```js
let numInvit√© = 0;

function Tasse() {
  // Mauvais: on modifie une variable existante!
  numInvit√© = numInvit√© + 1;
  return <h2>Tasse pour l'invit√© #{numInvit√©}</h2>;
}

export default function TeaSet() {
  return (
    <>
      <Tasse />
      <Tasse />
      <Tasse />
    </>
  );
}
```

</Sandpack>

---

### √âliminer les effets de bord

Pour r√©parer, on pourrait utiliser des props:

<Sandpack>

```js
function Tasse({ numInvit√© }) {
  return <h2>Tasse pour l'invit√© #{numInvit√©}</h2>;
}

export default function TeaSet() {
  return (
    <>
      <Tasse numInvit√©={1} />
      <Tasse numInvit√©={2} />
      <Tasse numInvit√©={3} />
    </>
  );
}
```

</Sandpack>

---

## Mode Strict

Il est plus simple de d√©tecter quand le rendu provoque des effets de bord avec le `<StrictMode>`.

Avec le `StrictMode`, quand on est en mode d√©veloppement, chaque composant est rendu 2 fois. √áa rend (parfois) les effets de bord plus visibles.

`StrictMode` sera ignor√© en production.

---

## Mutation locale

La mutation locale est permise. (C'est la mutation de variables pr√©existantes qui n'est pas permise.)

<Sandpack>

```js
function Tasse({ numInvit√© }) {
  return <h2>Tasse pour invit√© #{numInvit√©}</h2>;
}

export default function RassemblementDeTh√©() {
  let tasses = [];
  for (let i = 1; i <= 12; i++) {
    tasses.push(<Tasse key={i} numInvit√©={i} />);
  }
  return tasses;
}
```

</Sandpack>

Le code pr√©c√©dent est correct, car `tasses` est une variable locale. On peut modifier les variables locales sans probl√®mes.

Si `tasses` √©tait une variable globale, ce serait mauvais.

---

## O√π placer les effets de bords

Il faut √©viter les effets de bord dans le **rendu**.

Il est parfois n√©cessaire d'utiliser des effets de bord. On peut alors utiliser les gestionnaires d'√©v√©nements (event handlers), tel que `onClick` ou `onChange`.

Aussi, il est possible de r√©f√©rer une fonction dans `useEffect`, qui ex√©cute alors imm√©diatement apr√®s le rendu. (Similaire √† un gestionnaire d'√©v√©nement, **apr√®s** le rendu.)

---

### D√©fi 20

Ce composant tente de modifier la classe de `<h1>`. Quand il est entre minuit et 6 heures c'est "night", sinon c'est "day" le reste de la journ√©e. √áa ne marche pas. Peut-on r√©parer?

Testez en changeant l'heure de la nuit dans code, ou en changeant temporairement votre fuseau horaire.

<Sandpack>

```js src/Clock.js active
export default function Clock({ time }) {
  let hours = time.getHours();
  if (hours >= 0 && hours <= 12) {
    document.getElementById('time').className = 'night';
  } else {
    document.getElementById('time').className = 'day';
  }
  return <h1 id='time'>{time.toLocaleTimeString()}</h1>;
}
```

```js src/App.js hidden
import { useState, useEffect } from 'react';
import Clock from './Clock.js';

function useTime() {
  const [time, setTime] = useState(() => new Date());
  useEffect(() => {
    const id = setInterval(() => {
      setTime(new Date());
    }, 1000);
    return () => clearInterval(id);
  }, []);
  return time;
}

export default function App() {
  const time = useTime();
  return <Clock time={time} />;
}
```

```css
body > * {
  width: 100%;
  height: 100%;
}
.day {
  background: #fff;
  color: #222;
}
.night {
  background: #222;
  color: #fff;
}
```

</Sandpack>

---

### D√©fi 21

Les composants `Profile` sont rendus c√¥te-√†-c√¥te. D√®s qu'on interagit avec le bouton du premier profil, les donn√©es sont corrompues.

Il faut r√©parer ce code.

<Sandpack>

```js src/Profile.js active
import Panel from './Panel.js';
import { getImageUrl } from './utils.js';

let currentPerson;

export default function Profile({ person }) {
  currentPerson = person;
  return (
    <Panel>
      <Header />
      <Avatar />
    </Panel>
  );
}

function Header() {
  return <h1>{currentPerson.name}</h1>;
}

function Avatar() {
  return (
    <img
      className='avatar'
      src={getImageUrl(currentPerson)}
      alt={currentPerson.name}
      width={50}
      height={50}
    />
  );
}
```

```js src/Panel.js hidden
import { useState } from 'react';

export default function Panel({ children }) {
  const [open, setOpen] = useState(true);
  return (
    <section className='panel'>
      <button onClick={() => setOpen(!open)}>
        {open ? 'Collapse' : 'Expand'}
      </button>
      {open && children}
    </section>
  );
}
```

```js src/App.js
import Profile from './Profile.js';

export default function App() {
  return (
    <>
      <Profile
        person={{
          imageId: 'lrWQx8l',
          name: 'Subrahmanyan Chandrasekhar',
        }}
      />
      <Profile
        person={{
          imageId: 'MK3eW3A',
          name: 'Creola Katherine Johnson',
        }}
      />
    </>
  );
}
```

```js src/utils.js hidden
export function getImageUrl(person, size = 's') {
  return 'https://i.imgur.com/' + person.imageId + size + '.jpg';
}
```

```css
.avatar {
  margin: 5px;
  border-radius: 50%;
}
.panel {
  border: 1px solid #aaa;
  border-radius: 6px;
  margin-top: 20px;
  padding: 10px;
  width: 200px;
}
h1 {
  margin: 5px;
  font-size: 18px;
}
```

</Sandpack>

---

### D√©fi 22

Sur votre composant d'horloge, on demande d'afficher les derniers "t√©moignages". Vous avez un composant "Rang√©eT√©moignages" qui prend une liste de "t√©moignages". Vous ajoutez un "Ajoutez t√©moignage" au bout de cette liste. Ouille! Ceci g√©n√®re un doublon. Comment r√©parer?

<Sandpack>

```js src/RangeeTemoignages.js active
export default function RangeeTemoignages({ temoignages }) {
  temoignages.push({
    id: 'create',
    label: 'Ajouter t√©moignage',
  });

  return (
    <ul>
      {temoignages.map((temoignage) => (
        <li key={temoignage.id}>{temoignage.label}</li>
      ))}
    </ul>
  );
}
```

```js src/App.js hidden
import { useState, useEffect } from 'react';
import RangeeTemoignages from './RangeeTemoignages.js';

let temoignagesInitiaux = [
  { id: 0, label: 'T√©moignage de Sophie' },
  { id: 1, label: 'T√©moignage de Luc' },
];

export default function App() {
  let [temoignages, setTemoignages] = useState([...temoignagesInitiaux]);
  let time = useTime();

  // HACK: Prevent the memory from growing forever while you read docs.
  // We're breaking our own rules here.
  if (temoignages.length > 100) {
    temoignages.length = 100;
  }

  return (
    <div
      style={{
        width: '100%',
        height: '100%',
        textAlign: 'center',
      }}
    >
      <h2>Il est maintenant {time.toLocaleTimeString()}.</h2>
      <RangeeTemoignages temoignages={temoignages} />
    </div>
  );
}

function useTime() {
  const [time, setTime] = useState(() => new Date());
  useEffect(() => {
    const id = setInterval(() => {
      setTime(new Date());
    }, 1000);
    return () => clearInterval(id);
  }, []);
  return time;
}
```

```css
ul {
  margin: 0;
  list-style-type: none;
}

li {
  border: 1px solid #aaa;
  border-radius: 6px;
  float: left;
  margin: 5px;
  margin-bottom: 20px;
  padding: 5px;
  width: 70px;
  height: 100px;
}
```

```js src/sandbox.config.json hidden
{
  "hardReloadOnChange": true
}
```

</Sandpack>

---

## Devoir #2

Cr√©ez une WebApp React avec Vite qui doit afficher une liste de 5 vid√©os YouTube.

<aside style={{display:'grid', gridTemplateColumns:"1fr 1fr", columnGap:10}}>
<div>

Liste des vid√©os:

```js
const videos = [
  'SqcY0GlETPk',
  'bMknfKXIFA8',
  'Tn6-PIqc4UM',
  'b9eMGE7QtTk',
  'w7ejDZ8SWv8',
];
```

</div>
<div>
Comment afficher le premier vid√©o:

```html
<iframe
  width="480"
  height="270"
  src="https://www.youtube.com/embed/SqcY0GlETPk"
  allowfullscreen
  title="Video"
></iframe>
```

</div>
</aside>

---

## Devoir (1/3)

Pour ce devoir, vous devez compl√©ter le code du composant YouTube.

Voici une r√©f√©rence des [param√®tres](https://developers.google.com/youtube/player_parameters?hl=fr).
Vous pouvez am√©liorer l'exp√©rience.

Le r√©sultat final d√©sir√© ressemblerait √† ceci:

```jsx
<iframe
  type='text/html'
  width={480}
  height={270}
  src='https://www.youtube.com/embed/M7lc1UVf-VE'
  title='Vid√©o YouTube'
  frameBorder={0}
  allowFullscreen
/>
```

---

## Devoir (2/3)

Voici le code avec lequel vous allez d√©marrer:

```jsx
const videos = [
  {
    id: 'Tn6-PIqc4UM',
    name: 'React in 100 seconds',
  },
  {
    id: '8pDqJVdNa44',
    name: 'React.js: The Documentary',
  },
  {
    id: 'kvkAoCbTM3Q',
    name: 'Stop Using Create React App',
  },
];
```

---

## Devoir (3/3)

```jsx
export default function App() {
  return <ListerVideos videos={videos} />;
}

function ListerVideos({ videos }) {
  return (
    <>
      <h1>Liste de vid√©os</h1>
      {videos.map((video) => (
        <YouTube key={video.id} id={video.id} width={368} height={207} />
      ))}
    </>
  );
}

function YouTube({ id, width = 480, height = 270 }) {
  return '√† compl√©ter';
}
```
